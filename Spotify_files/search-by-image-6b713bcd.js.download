var n=Object.defineProperty;var m=(a,r,e)=>r in a?n(a,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[r]=e;var i=(a,r,e)=>(m(a,typeof r!="symbol"?r+"":r,e),e);import{_ as h}from"./preload-helper-be1680a6.js";import{r as d}from"./stimulus-helpers-50266f37.js";import{E as u}from"./ez-base-controller-29e49ea5.js";import{i as _}from"./tooltips-87e84986.js";import{t as c}from"./helpers-a84f7625.js";import{S as y,a as T}from"./ez-custom-events-439a5476.js";import{a as I}from"./ajax-helpers-b23bc37b.js";import"./js.cookie-c0fbedcc.js";import"./_commonjsHelpers-de833af9.js";import"./init-user-05a6553c.js";import"./index-266db5bb.js";import"./modal_helpers-630b4868.js";const f='<div class="ez-spinner ez-spinner--color-mono"></div>';class o extends u{constructor(){super(...arguments);i(this,"mobileTriggerSearchByImage",()=>{this.targetTarget.click()});i(this,"loadSearchByImageFormError",()=>{c(y)});i(this,"clearSearchByImageDragDrop",()=>{c(T)})}connect(){_(".search-by-image__open",{extraWrapperClass:"search-by-image-trigger-tooltip"}),this.initSearchByImage()}disconnect(){this.searchByImageTooltipInitialized=!1}loadSearchByImageForm(){setTimeout(()=>{var e;(e=this.popper)!=null&&e.querySelector(".search-by-image__choose-file__url-area")||I("/search_by_image_form",s=>{this.popper.querySelector(".tippy-content").innerHTML=s.data},()=>{this.loadSearchByImageFormError()})}),this.hasTriggerParentTarget&&this.triggerParentTarget.classList.add("has-search-by-image-ui"),this.hasSearchInputTarget&&(this.backupSearchPlaceholder=this.searchInputTarget.placeholder,this.searchInputTarget.placeholder=this.placeholderValue)}hideSearchByImageForm(e){e.classList.remove("is-active"),this.hasTriggerParentTarget&&this.triggerParentTarget.classList.remove("has-search-by-image-ui"),this.hasSearchInputTarget&&(this.searchInputTarget.placeholder=this.backupSearchPlaceholder),this.element.querySelector(".search-by-image__choose-file__url-area")&&(this.element.removeAttribute("data-disable-form-submit"),this.clearSearchByImageDragDrop())}initSearchByImage(){if(!this.searchByImageTooltipInitialized){const e=this,s=this.hasTriggerParentTarget?this.triggerParentTarget:"parent";h(()=>import("./tippy.esm-a79def68.js"),[]).then(g=>{const p=g.default;p(this.targetTargets,{content:f,allowHTML:!0,animation:"rising",interactive:!0,appendTo:s,placement:"bottom-end",theme:"search-by-image",delay:[0,null],duration:0,maxWidth:"none",offset:[0,10],trigger:"click",popperOptions:{modifiers:[{name:"flip",enabled:!1}]},onCreate(t){t.popper.classList.add("search-by-image-tooltip")},onTrigger(t,l){e.element.setAttribute("data-disable-form-submit",!0),e.urlField=t.popper.querySelector('[data-search-by-image-target="urlField"]'),this.instanceTarget=l.currentTarget,this.instanceTarget.classList.add("is-active")},onShow(t){e.popper=t.popper,e.loadSearchByImageForm()},onHide(t){e.popper=t.popper,e.hideSearchByImageForm(this.instanceTarget)}}),this.searchByImageTooltipInitialized=!0})}}}i(o,"targets",["searchInput","triggerParent","target"]),i(o,"values",{verticalOffset:Number,placeholder:String});d([["search-by-image",o],["search-by-image-drag-drop",h(()=>import("./search-by-image-drag-drop-controller-fbe75d6b.js"),[])]]);
