import{_ as d}from"./preload-helper-be1680a6.js";import{C as p,r as w}from"./stimulus-helpers-50266f37.js";import"./index-76fb7be0.js";import{E as S}from"./ez-base-controller-29e49ea5.js";import{e as l}from"./events-1a058a8a.js";import{t as n}from"./helpers-a84f7625.js";import y from"./ez-form-select-field-controller-51434331.js";import{E}from"./modal-controller-1e6d1815.js";import{G as m}from"./ez-custom-events-439a5476.js";import{M as k}from"./media-matcher-b9d0b27a.js";import"./_commonjsHelpers-de833af9.js";import"./js.cookie-c0fbedcc.js";import"./init-user-05a6553c.js";import"./rails-ujs-c791118a.js";class g extends S{constructor(){super(...arguments),this.blurSubMenus=e=>{const t=document.querySelectorAll(".ez-drop-down.is-open"),i=e.target.closest(".ez-drop-down");t&&t.forEach(s=>{i!==s&&(n(l.util.ez_drop_down.close_drop_down,s),n(l.util.ez_drop_down.close_drop_down,{},s))})},this.closeDropDown=()=>{this.toggleSubMenu(this.element)},this.allowEscClose=e=>{e.keyCode===27&&this.blurSubMenus(e)}}connect(){this.element.addEventListener(l.util.ez_drop_down.close_drop_down,this.closeDropDown),window.addEventListener("keyup",this.allowEscClose),document.addEventListener("click",this.blurSubMenus)}disconnect(){this.element.removeEventListener(l.util.ez_drop_down.close_drop_down,this.closeDropDown),window.removeEventListener("keyup",this.allowEscClose),document.removeEventListener("click",this.blurSubMenus)}handleSubMenuClick(){const e=this.element;this.toggleSubMenu(e)}closeExploreMenuItems(){n("CloseSearchExploreSubMenus")}toggleSubMenu(e){e.classList.toggle("is-closed"),e.classList.toggle("is-open")}}class a extends S{connect(){this.flagLoaded()}on(){this.elementTargets.forEach(e=>{e.classList.add(...this.nameClasses)})}off(){this.elementTargets.forEach(e=>{e.classList.remove(...this.nameClasses)})}}a.classes=["name"];a.targets=["element"];function u(o){let e;return(...t)=>{e&&cancelAnimationFrame(e),e=requestAnimationFrame(()=>{o(...t)})}}const c=new k;class h extends p{constructor(){super(...arguments),this.lastScrolledPosition=window.scrollY,this.isScrolled=!1,this.setupSticky=()=>{this.setupStickyMediaQueries(),this.initialState(),window.addEventListener("scroll",this.normalScrollCheck)},this.initialState=()=>{this.stickElement(),this.showElement(),this.isCloseToTop()&&this.hideStickyHeaderSearchBar(),window.addEventListener("scroll",this.dynamicScrollCheck)},this.disableDynamicSticky=()=>{this.stickElement(),this.showElement(),window.removeEventListener("scroll",this.dynamicScrollCheck)},this.isScrollingUp=()=>this.lastScrolledPosition>window.scrollY,this.isScrolledToTop=()=>window.scrollY<=0,this.isCloseToTop=(e=!1)=>{const t=this.element,i=e?50:0;return window.scrollY<=t.offsetHeight+i},this.hasScrolledPastLastStickyElement=()=>{const e=document.querySelectorAll('[data-controller*="dynamic-sticky"]'),i=Array.from(e).reduce((s,r)=>{const f=s.offsetTop+s.offsetHeight;return r.offsetTop+r.offsetHeight>f?r:s});return window.scrollY>i.clientHeight},this.showElement=()=>{this.element.classList.contains(this.isStickyClass)&&(this.element.classList.remove(this.hideElementClass),this.element.classList.add(this.showElementClass),this.showStickyHeaderSearchBar(),this.applyStickyOffset())},this.hideElement=()=>{this.element.classList.remove(this.showElementClass),this.element.classList.add(this.hideElementClass),this.removeStickyOffset()},this.unstickElement=()=>{this.element.classList.remove(this.showElementClass),this.element.classList.remove(this.isStickyClass)},this.stickElement=()=>{this.element.classList.add(this.isStickyClass)},this.showStickyHeaderSearchBar=(e=!1)=>{this.mainSearchBar&&(!this.isCloseToTop(!0)||e)&&(this.mainSearchBar.classList.add("is-visible"),this.searchField.disabled=!1)},this.applyStickyOffset=()=>{if(this.offsetElementSelectorValue){const e=document.querySelector(this.offsetElementSelectorValue),t=this.element;t.style.top=`${e.offsetHeight}px`}},this.removeStickyOffset=()=>{const e=this.element;e.style.top="0"},this.applyStickyHeader=()=>{this.isScrollingUp()?this.scrollingUpActions():this.scrollingDownActions(),this.lastScrolledPosition=window.scrollY},this.scrollingUpActions=()=>{this.showElement(),this.isScrolledToTop()&&this.unstickElement(),this.isCloseToTop()&&this.hideStickyHeaderSearchBar()},this.scrollingDownActions=()=>{this.hasScrolledPastLastStickyElement()&&(this.stickElement(),this.hideElement())},this.checkScroll=()=>{window.scrollY>this.scrollOffsetValue&&this.isScrolled===!1?(document.body.classList.add("is-scrolled"),this.isScrolled=!0):window.scrollY<=0&&this.isScrolled===!0&&(document.body.classList.remove("is-scrolled"),this.isScrolled=!1)},this.normalScrollCheck=u(this.checkScroll),this.dynamicScrollCheck=u(()=>{this.applyStickyHeader()})}connect(){this.waitToGetSticky()?window.addEventListener(m,this.setupSticky):this.setupSticky(),window.addEventListener("resize",this.applyStickyOffset)}disconnect(){window.removeEventListener(m,this.setupSticky),window.removeEventListener("resize",this.applyStickyOffset),window.removeEventListener("scroll",this.normalScrollCheck),window.removeEventListener("scroll",this.dynamicScrollCheck)}setupStickyMediaQueries(){c.addMediaQuery("(max-width: 635px)",()=>this.showStickyHeaderSearchBar(!0),this.initialState),c.evaluateAll(),c.addListeners()}hideStickyHeaderSearchBar(){!this.mobileSearchButtonVisible()&&document.body.classList.contains("main-search-soft-hidden")&&this.mainSearchBar&&(this.mainSearchBar.classList.remove("is-visible"),this.searchField.disabled=!0)}mobileSearchButtonVisible(){const e=document.querySelector('[data-action*="click->site-header#toggleMobileSearch"]');return e?getComputedStyle(e).display!=="none":!1}waitToGetSticky(){return window.waitToGetSticky||this.waitToInitValue}get mainSearchBar(){return document.querySelector(".ez-site-header__search-fullwidth")}get searchField(){return this.mainSearchBar.querySelector(".ez-search-form__input")}}h.classes=["isSticky","showElement","hideElement"];h.values={mobileOnly:{type:Number,default:0},waitToInit:{type:Boolean,default:!1},offsetElementSelector:String,scrollOffset:{type:Number,default:0}};w([["ez-drop-down",g],["ez-form-select",y],["ez-modal",E],["toggle-class",a],["dynamic-sticky",h],["scroll-top",d(()=>import("./scroll-top-controller-3dcba586.js"),[])],["success-modal",d(()=>import("./success-modal-controller-92994721.js"),[])]]);
